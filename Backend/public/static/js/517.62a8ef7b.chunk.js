"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[517],{1517:(e,t,s)=>{s.r(t),s.d(t,{default:()=>F});var o=s(5043),n=s(9602),l=s(7419),r=s(1645),i=s(7021),a=s(3216),d=s(1474),c=s(3722),u=s(7730),g=s(5546),p=s(7170),h=s(9126),f=s(800),m=s(579);const{Header:x,Content:y,Sider:v}=g.A,A=[d.A,c.A,u.A].map(((e,t)=>{let s="";return e===d.A?s="Home":e===c.A?s="Profile":e===u.A&&(s="Notifications"),{key:"".concat(s),icon:o.createElement(e),label:s}})),j=e=>{let{children:t}=e;const s=(0,a.Zp)(),{token:{colorBgContainer:o,borderRadiusLG:n}}=p.A.useToken();return(0,m.jsxs)(g.A,{style:{height:"100vh",width:"100%"},children:[(0,m.jsx)(x,{style:{display:"flex",alignItems:"center"},children:(0,m.jsx)("img",{alt:"logo",src:"https://1000logos.net/wp-content/uploads/2021/10/logo-Meta.png",style:{height:50,width:70},className:"demo-logo"})}),(0,m.jsxs)(g.A,{children:[(0,m.jsx)(v,{width:200,style:{background:o},children:(0,m.jsx)(h.A,{mode:"inline",defaultSelectedKeys:["1"],defaultOpenKeys:["sub1"],style:{height:"100%",borderRight:0},onClick:e=>s("/".concat(e.key.toLowerCase())),items:A})}),(0,m.jsxs)(g.A,{style:{padding:"0 24px 24px"},children:[(0,m.jsx)(f.A,{style:{margin:"16px 0"},children:(0,m.jsx)(f.A.Item,{children:"Home"})}),(0,m.jsx)(y,{style:{padding:24,margin:0,minHeight:280,background:o,borderRadius:n},children:t})]})]})]})};var S=s(5967),w=s(5397),b=s(9748),k=s(8167),C=s(7692),I=s(2154);const{Title:T,Text:D}=S.A,q=e=>{var t,s;let{poll:l}=e;const[r,a]=o.useState((null===(t=l.options.find((e=>e.votedByUser)))||void 0===t?void 0:t._id)||"");return(0,m.jsxs)(w.A,{style:{width:"100%",backgroundColor:"#075E54",color:"#fff",borderRadius:10,padding:"20px"},children:[(0,m.jsxs)(T,{level:4,style:{color:"#fff"},children:[l.question," ?"]}),(0,m.jsx)(D,{style:{color:"#fff"},children:"Select one or more"}),(0,m.jsxs)(b.A,{onFinish:e=>{console.log("View submitted:",e)},children:[(0,m.jsx)(b.A.Item,{name:"vote",children:(0,m.jsx)(k.Ay.Group,{style:{width:"100%"},onChange:async e=>{if(l.answered)return n.Ay.error({message:"Question is required",description:"Please enter a question"});let t={poll_id:e.target.value,_id:l._id};try{var s;let{data:e}=await((e,t)=>(0,I.$)("POST","/poll/vote-poll",e,t))(t,null===(s=JSON.parse(localStorage.getItem("userData")))||void 0===s?void 0:s.token);if(200===e.code)return n.Ay.success({message:"Poll Added",description:"Your poll has been added successfully."})}catch(d){var o,r,i,a;return n.Ay.error({message:"Some error occurred while saving",description:null!==(o=null!==(r=null===d||void 0===d?void 0:d.message)&&void 0!==r?r:null===d||void 0===d||null===(i=d.response)||void 0===i||null===(a=i.data)||void 0===a?void 0:a.message)&&void 0!==o?o:"Something went wrong"})}},value:r,defaultValue:(null===(s=l.options.find((e=>e.votedByUser)))||void 0===s?void 0:s._id)||"",disabled:l.answered,children:l.options.map(((e,t)=>(0,m.jsxs)("div",{style:{},children:[(0,m.jsx)(k.Ay,{value:e._id,style:{color:"#fff"},children:e.answer},e._id),(0,m.jsx)(C.A,{percent:e.votes/l.answeredCount*100,showInfo:!1,strokeColor:"#128C7E"})]},e._id)))})}),(0,m.jsx)("div",{style:{textAlign:"right",color:"#fff"},children:"9:19 am"}),(0,m.jsx)(b.A.Item,{children:(0,m.jsx)(i.Ay,{type:"primary",htmlType:"submit",style:{marginTop:10,backgroundColor:"#25D366",borderColor:"#25D366"},children:"View votes"})})]})]})};var E=s(8632),N=s(4088),R=s(7534),_=s(4419),O=s(8758),B=s(2297),P=s(6833),z=s(4394);var L=s(6178),J=s.n(L);const{Text:Y}=S.A,M=e=>{let{text:t,time:s,isSender:o,createdBy:n}=e;return(0,m.jsxs)("div",{style:{display:"flex",justifyContent:o?"flex-end":"flex-start",marginBottom:"10px"},children:[!o&&(0,m.jsx)(E.A,{style:{backgroundColor:"#87d068",marginRight:"10px"},children:(0,m.jsx)("span",{style:{color:"#fff"},children:n.fullname.split("")[0]})}),(0,m.jsx)(w.A,{style:{borderRadius:"20px",backgroundColor:o?"#e6f7ff":"#87d068",color:o?"#000":"#fff",maxWidth:"60%",textAlign:o?"right":"left"},children:t}),(0,m.jsx)("div",{style:{marginLeft:"10px",marginRight:"10px",alignSelf:"flex-end"},children:(0,m.jsx)(Y,{type:"secondary",style:{fontSize:"12px"},children:s})})]})},G=e=>{var t;let{socket:s}=e,[l,r]=o.useState([]),[a,d]=o.useState("");const c=o.useRef(null);let u=null===(t=JSON.parse(localStorage.getItem("userData")))||void 0===t?void 0:t._id;const g=async()=>{try{let{data:e}=await(l=JSON.parse(localStorage.getItem("userData")).token,(0,I.$)("GET","/chat/get-chat",null,l));200===e.code&&r(e.data)}catch(i){var e,t,s,o;return n.Ay.error({message:"Some error occurred while saving",description:null!==(e=null!==(t=null===i||void 0===i?void 0:i.message)&&void 0!==t?t:null===i||void 0===i||null===(s=i.response)||void 0===s||null===(o=s.data)||void 0===o?void 0:o.message)&&void 0!==e?e:"Something went wrong"})}var l};o.useEffect((()=>{g()}),[]);const p=()=>{document.getElementById("typingStatus").innerText="typing...",setTimeout((()=>{document.getElementById("typingStatus").innerText=""}),1500)},h=e=>{r((t=>[...t,e]))};return o.useEffect((()=>{c.current&&(c.current.scrollTop=c.current.scrollHeight)}),[l]),o.useEffect((()=>(s.on("typing",p),s.on("chat message",h),()=>{s.off("typing",p),s.off("chat message",h)})),[]),(0,m.jsxs)("div",{style:{display:"flex",flexDirection:"column",height:"80vh",width:"100%",margin:"auto",border:"1px solid #d9d9d9",borderRadius:"10px",top:"-100px"},children:[(0,m.jsxs)("div",{style:{padding:"10px",display:"flex",alignItems:"center",backgroundColor:"#f0f2f5",borderBottom:"1px solid #d9d9d9"},children:[(0,m.jsx)(E.A,{size:"large",src:"https://via.placeholder.com/150"}),(0,m.jsxs)("div",{style:{marginLeft:"10px"},children:[(0,m.jsx)(Y,{strong:!0,children:"Group Chat"}),(0,m.jsx)("div",{style:{fontSize:"12px",color:"#52c41a"},id:"typingStatus"})]}),(0,m.jsxs)("div",{style:{marginLeft:"auto"},children:[(0,m.jsx)(R.A,{style:{fontSize:"20px",marginRight:"10px"}}),(0,m.jsx)(_.A,{style:{fontSize:"20px",marginRight:"10px"}}),(0,m.jsx)(O.A,{style:{fontSize:"20px"}})]})]}),(0,m.jsx)("div",{style:{flex:1,padding:"10px",overflowY:"scroll",backgroundColor:"#fff"},ref:c,children:l.map(((e,t)=>(0,m.jsx)(M,{createdBy:e.createdBy,text:e.message,time:J()(e.time).format("MMMM Do YYYY, h:mm:ss a"),isSender:e.createdBy._id===u},e._id)))}),(0,m.jsxs)("div",{style:{padding:"10px",display:"flex",alignItems:"center",borderTop:"1px solid #d9d9d9",backgroundColor:"#f0f2f5"},children:[(0,m.jsx)(B.A,{style:{fontSize:"20px",marginRight:"10px"}}),(0,m.jsx)(P.A,{style:{fontSize:"20px",marginRight:"10px"}}),(0,m.jsx)(N.A,{placeholder:"Type your message...",style:{flex:1,borderRadius:"20px"},value:a,onChange:e=>{s.emit("typing"),d(e.target.value)}}),(0,m.jsx)(i.Ay,{type:"primary",shape:"circle",icon:(0,m.jsx)(z.A,{}),style:{marginLeft:"10px",backgroundColor:"#87d068",borderColor:"#87d068"},onClick:()=>{a&&(s.emit("chat message",{message:a,nick:JSON.parse(localStorage.getItem("userData")).name}),d(""))}})]})]})};var H=s(6616);const V=e=>{let{isVisible:t,onClose:s,onSave:n}=e;const[l]=b.A.useForm(),[r,a]=(0,o.useState)(["",""]);return(0,m.jsx)(H.A,{title:"Add New Poll",visible:t,onCancel:s,onOk:()=>{try{l.validateFields().then((e=>{n({...e,answers:r}),l.resetFields(),a(["",""])}))}catch(e){}},okText:"Save",children:(0,m.jsxs)(b.A,{form:l,layout:"vertical",children:[(0,m.jsx)(b.A.Item,{label:"Question",name:"question",rules:[{required:!0,message:"Please input the question!"}],children:(0,m.jsx)(N.A,{placeholder:"Enter your question"})}),r.map(((e,t)=>(0,m.jsx)(b.A.Item,{label:"Answer ".concat(t+1),rules:[{required:!0,message:"Please input the answer!"}],children:(0,m.jsx)(N.A,{value:e,onChange:e=>((e,t)=>{const s=[...r];s[e]=t,a(s)})(t,e.target.value),placeholder:"Enter an answer"})},t))),(0,m.jsx)(b.A.Item,{children:(0,m.jsx)(i.Ay,{type:"dashed",onClick:()=>{a([...r,""])},children:"Add More Answers"})})]})})};const $=(0,s(5749).io)(),F=()=>{const e=(0,a.Zp)();o.useEffect((()=>{if($.connect(),!localStorage.getItem("userData"))return e("/login")}),[]);const[t,s]=o.useState($.connected),[d,c]=(0,o.useState)(!1),[u,g]=(0,o.useState)([]),[p,h]=n.Ay.useNotification();o.useEffect((()=>{function e(){let e=setInterval((()=>{try{console.log("Trying to connect"),t||($.connected||$.connect(),$.emit("auth",JSON.stringify({token:JSON.parse(localStorage.getItem("userData")).token}))),clearInterval(e)}catch(s){clearInterval(e)}}),700);s(!0)}function o(){s(!1),console.log("disconnect"),e()}function n(){f()}return $.on("connect",e),$.on("disconnect",o),$.on("poll_added",n),e(),()=>{$.off("connect",e),$.off("disconnect",o),$.off("poll_added",n)}}),[]);const f=async()=>{try{const{data:e}=await(n=JSON.parse(localStorage.getItem("userData")).token,(0,I.$)("GET","/poll/get-poll",null,n));e.data.length&&g(e.data),p.open({message:"Data fetched successfully",description:"Data fetched successfully",duration:5e3})}catch(l){var e,t,s,o;p.open({message:"Some error occurred",description:null!==(e=null!==(t=null===l||void 0===l?void 0:l.message)&&void 0!==t?t:null===l||void 0===l||null===(s=l.response)||void 0===s||null===(o=s.data)||void 0===o?void 0:o.message)&&void 0!==e?e:"Something went wrong",duration:5e3})}var n};o.useEffect((()=>{f()}),[]);return(0,m.jsxs)(j,{children:[t?"Connected":"Disconnected",h,(0,m.jsxs)(l.A,{gutter:0,className:"home-container",style:{height:"84vh"},children:[(0,m.jsxs)(r.A,{span:12,className:"leftside",style:{overflowY:"auto",padding:"10px",height:"80vh"},children:[(0,m.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(0,m.jsx)(i.Ay,{type:"primary",style:{margin:10},onClick:()=>{c(!0)},children:"ADD POLL"})}),u.map(((e,t)=>(0,m.jsx)(q,{poll:e},e._id)))]}),(0,m.jsx)(r.A,{span:12,className:"rightside",style:{height:"100%"},children:(0,m.jsx)(G,{socket:$})})]}),(0,m.jsx)(V,{isVisible:d,onClose:()=>{c(!1)},onSave:async e=>{if(!e.question)return n.Ay.error({message:"Question is required",description:"Please enter a question"});let t=null===e||void 0===e?void 0:e.answers.map((e=>({answer:e})));if(!t||(null===t||void 0===t?void 0:t.length)<=1)return n.Ay.error({message:"Answer is required",description:"Min 2 is required"});let s={question:e.question,options:t};try{let{data:e}=await((e,t)=>(0,I.$)("POST","/poll/create-poll",e,t))(s,JSON.parse(localStorage.getItem("userData")).token);if(200===e.code)return c(!1),n.Ay.success({message:"Poll Added",description:"Your poll has been added successfully."})}catch(a){var o,l,r,i;return n.Ay.error({message:"Some error occurred while saving",description:null!==(o=null!==(l=null===a||void 0===a?void 0:a.message)&&void 0!==l?l:null===a||void 0===a||null===(r=a.response)||void 0===r||null===(i=r.data)||void 0===i?void 0:i.message)&&void 0!==o?o:"Something went wrong"})}}})]})}},2154:(e,t,s)=>{s.d(t,{$:()=>n,y:()=>l});const o=s(6213).A.create({baseURL:""}),n=(e,t,s,n)=>o({method:e,url:t,data:s,headers:{Authorization:"Bearer ".concat(n)}}),l=(e,t,s)=>o({method:e,url:t,data:s})}}]);
//# sourceMappingURL=517.62a8ef7b.chunk.js.map